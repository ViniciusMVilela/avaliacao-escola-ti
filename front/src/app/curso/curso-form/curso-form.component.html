<div>
  <div>
    <h2>{{ isEdit ? "Editar" : "Novo" }} Curso</h2>

    <form [formGroup]="cursoForm" (ngSubmit)="onSubmit()">
      <div>
        <label for="nome">Nome do Curso *</label>
        <input type="text" id="nome" formControlName="nome" />
        <div *ngIf="cursoForm.get('nome')?.invalid && cursoForm.get('nome')?.touched">
          <span *ngIf="cursoForm.get('nome')?.errors?.['required']">
            Nome é obrigatório
          </span>
          <span *ngIf="cursoForm.get('nome')?.errors?.['maxlength']">
            Nome deve ter no máximo 50 caracteres
          </span>
        </div>
      </div>

      <div>
        <label for="cargaHoraria">Carga Horária *</label>
        <input type="number" id="cargaHoraria" formControlName="cargaHoraria" />
        <div *ngIf="cursoForm.get('cargaHoraria')?.invalid && cursoForm.get('cargaHoraria')?.touched">
          <span *ngIf="cursoForm.get('cargaHoraria')?.errors?.['required']">
            Carga horária é obrigatória
          </span>
          <span *ngIf="cursoForm.get('cargaHoraria')?.errors?.['min']">
            Carga horária deve ser maior que 0
          </span>
        </div>
      </div>

      <div>
        <label for="dataInicio">Data de Início *</label>
        <input type="date" id="dataInicio" formControlName="dataInicio" />
        <div *ngIf="cursoForm.get('dataInicio')?.invalid && cursoForm.get('dataInicio')?.touched">
          <span *ngIf="cursoForm.get('dataInicio')?.errors?.['required']">
            Data de início é obrigatória
          </span>
          <span *ngIf="cursoForm.get('dataInicio')?.errors?.['datePast']">
            Data de início não pode ser anterior à data atual
          </span>
        </div>
      </div>

      <div>
        <h3>Disciplinas do Curso</h3>
        <div>
          <label for="disciplinaSelect">Adicionar Disciplina</label>
          <select id="disciplinaSelect" #disciplinaSelect>
            <option value="">Selecione uma disciplina</option>
            <option *ngFor="let disciplina of getDisciplinasDisponiveis()" [value]="disciplina.id">
              {{ disciplina.nome }}
            </option>
          </select>
          <button
            type="button"
            (click)="adicionarDisciplinaPorId(disciplinaSelect.value); disciplinaSelect.value = ''">
            Adicionar
          </button>
        </div>

        <div *ngIf="disciplinasSelecionadas.length > 0">
          <h4>Disciplinas Vinculadas</h4>
          <ul>
            <li *ngFor="let disciplina of disciplinasSelecionadas">
              {{ disciplina.nome }}
              <button type="button" (click)="removerDisciplina(disciplina)">
                Remover
              </button>
            </li>
          </ul>
        </div>
      </div>

      <div>
        <button type="button" (click)="goBack()">Cancelar</button>
        <button type="submit" [disabled]="cursoForm.invalid || loading">
          {{ loading ? "Salvando..." : "Salvar" }}
        </button>
      </div>
    </form>
  </div>
</div>
